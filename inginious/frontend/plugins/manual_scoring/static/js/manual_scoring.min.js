class CodeField{constructor(){this.environmentType=environmentType(),this.multilangCodeArea=$("#myTextCode")[0],this.displayCodeArea()}displayCodeArea(){this.isNotebook()?this.getNotebookCodeDataAndRender():this.showMultiLangCodeArea()}isNotebook(){return"Notebook"===this.environmentType}getNotebookCodeDataAndRender(){$.ajax({url:getURLSubmissionCode(),method:"GET",dataType:"json",success:function(e){render_notebook(e)}})}showMultiLangCodeArea(){$("#myTextCodeArea").show();const e=languages[this.multilangCodeArea.getAttribute("data-language")];registerCodeEditor(this.multilangCodeArea,e,20).setOption("readOnly","nocursor")}}class MessageBox{constructor(e, t, s, i=!0){this.divElement=document.getElementById(e),this.textContent=t,this.type=s,this.dismissible=i,this.generateHtmlCode(),this.displayBoxMessage()}generateHtmlCode(){let e='<div class="alert fade in ';this.dismissible&&(e+="alert-dismissible "),e+="alert-"+this.type+'" role="alert">',this.dismissible&&(e+='<button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>'),e+=this.textContent,e+="</div>",this.code=e}displayBoxMessage(){this.divElement.innerHTML+=this.code,this.divElement.style.display="block",this.dismissible&&this.doDisappearEffect()}doDisappearEffect(){let e=1;const t=this.divElement,s=setInterval(function(){e<=.1&&(t.style.display="none",clearInterval(s),t.innerHTML=""),t.style.opacity=e,t.style.filter="alpha(opacity="+100*e+")",e-=.05*e},100)}}class RubricScoring{constructor(){this.score=0,this.matrix=[],this.matrixLength=5,this.classMarkerId="box1",this.scoreTextId="output",this.formMatrixRespectRubric(),this.addListeners()}formMatrixRespectRubric(){for(let e=0; e<this.matrixLength; e++){this.matrix[e]=[];for(let t=0; t<this.matrixLength; t++){let s=new MatrixField(e,t);this.matrix[e][t]=document.getElementById(s.fieldId)}}}addListeners(){for(let e=0; e<this.matrixLength; e++)for(let t=0; t<this.matrixLength; t++){let s=new MatrixField(e,t);this.addSelectFunction(s),this.addDeselectFunction(s),this.changeCursorToPointerWhenIsOver(s),this.changeCursorToDefaultWhenIsOut(s)}}addSelectFunction(e){const t=this;this.matrix[e.iIndex][e.jIndex].addEventListener("click",function(){t.removeSelectionOnRow(e.iIndex),t.addMarkerClass(e.fieldId),t.updateScore(e.jIndex)})}addDeselectFunction(e){const t=this;this.matrix[e.iIndex][e.jIndex].addEventListener("dblclick",function(){t.removeMarkerClass(e.fieldId),t.updateScore(e.jIndex,!1)})}changeCursorToPointerWhenIsOver(e){this.matrix[e.iIndex][e.jIndex].addEventListener("mouseover",function(){document.body.style.cursor="pointer"})}changeCursorToDefaultWhenIsOut(e){this.matrix[e.iIndex][e.jIndex].addEventListener("mouseout",function(){document.body.style.cursor="default"})}removeSelectionOnRow(e){for(let t=0; t<this.matrixLength; t++){let s=new MatrixField(e,t);if(this.isFieldSelected(s)){this.removeMarkerClass(s.fieldId),this.updateScore(t,!1);break}}}addMarkerClass(e){document.getElementById(e).classList.add(this.classMarkerId)}removeMarkerClass(e){document.getElementById(e).classList.remove(this.classMarkerId)}isFieldSelected(e){return this.matrix[e.iIndex][e.jIndex].classList.contains(this.classMarkerId)}updateScoreText(){document.getElementById(this.scoreTextId).innerHTML="Current Score: "+this.score.toFixed(1)}updateScore(e, t=!0){t?this.score+=.2*(e+1):this.score-=.2*(e+1),this.updateScoreText()}}class MatrixField{constructor(e, t){this.iIndex=e,this.jIndex=t}get fieldId(){return`${this.iIndex}-${this.jIndex}`}}const languages={java7:"java",java8:"java",cpp:"cpp",cpp11:"cpp",c:"c",c11:"c",python3:"python",vhdl:"vhdl",verilog:"verilog"},responseFieldId="grade_edit_submit_status",feedbackFieldId="task_alert";function commentSubmit(){const e=document.getElementById("text_comment");if(e.value.length>1e3){new MessageBox(responseFieldId,"Error at saving Comment, comment to long, max length of comment is 1000.","warning")}else jQuery.ajax({success:function(e){new MessageBox(responseFieldId,"Successfully saved","info")},method:"POST",data:{comment:e.value},error:function(e, t, s){new MessageBox(responseFieldId,"Error at saving Comment, please try again.","danger")}})}function save(e){jQuery.ajax({success:function(e){commentSubmit();new MessageBox(responseFieldId,"Submission graded and stored","info")},method:"POST",data:{grade:e.score.toFixed(1)},error:function(e, t, s){new MessageBox(responseFieldId,"Something went wrong","danger")}})}function loadFeedBack(){const e=getHtmlCodeForFeedBack(),t=getTextBoxTypeBaseOnResult();new MessageBox(feedbackFieldId,e,t,!1)}function addToggleBehaviorToProblemDescription(){$("#info").click(function(){$("#text-context").collapse("toggle")})}function addSaveFunctionToSaveButton(e){$("#save_button").click(function(){save(e)})}function isRubricScoringPage(){return new RegExp("[a-z0-9A-Z\\-_]+/admin/[a-z0-9A-Z\\-_]+/manual_scoring/task/[a-z0-9A-Z\\-_]+/submission/[a-z0-9A-Z\\-_]+").test(document.location.href)}jQuery(document).ready(function(){if(isRubricScoringPage()){new CodeField;const e=new RubricScoring;addToggleBehaviorToProblemDescription(),loadFeedBack(),addSaveFunctionToSaveButton(e)}window.save=save});