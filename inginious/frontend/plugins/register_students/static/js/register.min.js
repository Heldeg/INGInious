jQuery(document).ready(function(){let e=!1;function t(e){let t=$("#register_students_alert");t.prop("class","alert alert-info"),t.text(e),t.prop("hidden",!1)}function s(){$("#register_students_modal").modal({backdrop:"",keyboard:!0}),$("#register_students_modal button[data-dismiss=modal]").each(function(){$(this).prop("disabled",!1)})}$("#register_students_modal").on("hidden.bs.modal",function(){e?window.location.replace(window.location.href):($("#students_file").val(""),$("#register_students_alert").prop("hidden",!0))}),$("#tab_students").append("<br><button class='btn btn-success' data-toggle='modal' data-target='#register_students_modal'><i class='fa fa-users'></i> Register students</button>"),$("form#upload_students_file").submit(function(i){i.preventDefault();let a=$("#students_file").prop("files")[0];if(void 0===a)t("Please select a file before submitting it.");else if(/(\.csv)$/i.exec(a.name)){let i=new FormData;i.append("file",a),i.append("course",window.location.href.split("/")[4]),$.ajax({url:"/api/addStudents/",method:"POST",dataType:"json",data:i,mimeType:"multipart/form-data",processData:!1,contentType:!1,beforeSend:function(){$("#submit_register_students").prop("disabled",!0),$("#register_students_modal").modal({backdrop:"static",keyboard:!1}),$("#register_students_modal button[data-dismiss=modal]").each(function(){$(this).prop("disabled",!0)}),function(){let e=$("#register_students_alert");e.prop("class","alert alert-info"),e.text("Registering students..."),e.prop("hidden",!1)}()},success:function(i){!function(s){if("status"in s&&"error"===s.status)t(s.text);else if("status"in s&&"success"===s.status){let t=$("#register_students_alert");e=!0,$("#students_file").val(""),t.prop("class","alert alert-success"),t.text(s.text),t.prop("hidden",!1),setTimeout(function(){t.prop("hidden",!0)},1e4)}else t("An error occurred while registering. Please try again.")}(i),s(),$("#submit_register_students").prop("disabled",!1)},error:function(e){t(e),s(),$("#submit_register_students").prop("disabled",!1)}})}else t("The inserted file should be a .csv file.")})});